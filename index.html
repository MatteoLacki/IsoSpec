<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <title>Isospec by MatteoLacki</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>Isospec</h1>
        <h2>Hyperfast Isotopic Structure Calculator.</h2>

        <section id="downloads">
          <a href="https://github.com/MatteoLacki/IsoSpec/zipball/master" class="btn">Download as .zip</a>
          <a href="https://github.com/MatteoLacki/IsoSpec/tarball/master" class="btn">Download as .tar.gz</a>
          <a href="https://github.com/MatteoLacki/IsoSpec" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h2>
<a id="what-is-isospec" class="anchor" href="#what-is-isospec" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>What is IsoSpec?</h2>

<p>IsoSpec is a <strong>fine structure isotopic calculator</strong>.</p>

<p>Given a molecular formula and some probability threshold <em>0 &lt; P &lt; 1</em>, it will provide you with the smallest possible set of <a href="http://goldbook.iupac.org/I03351.html">isotopologues</a> that are jointly <em>P</em> probable. </p>

<h3>
<a id="example" class="anchor" href="#example" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><em>Example</em>
</h3>

<p>Say, that you happen to be interested in the top 50% probable isotopologues of <a href="http://www.rcsb.org/pdb/explore.do?structureId=2zp6"><em>Bovine Insulin</em></a>. We happen to know, that its molecular formula is C<sub>254</sub>H<sub>377</sub>N<sub>65</sub>O<sub>75</sub>S<sub>6</sub>. </p>

<p>In that case, IsoSpec would provide you with:</p>

<table>
<thead>
<tr>
<th align="right">mass</th>
<th align="right">probability</th>
<th align="right">
<sup>1</sup>H</th>
<th align="right">
<sup>2</sup>H</th>
<th align="right">
<sup>12</sup>C</th>
<th align="right">
<sup>13</sup>C</th>
<th align="right">
<sup>14</sup>N</th>
<th align="right">
<sup>15</sup>N</th>
<th align="right">
<sup>16</sup>O</th>
<th align="right">
<sup>17</sup>O</th>
<th align="right">
<sup>18</sup>O</th>
<th align="right">
<sup>32</sup>S</th>
<th align="right">
<sup>33</sup>S</th>
<th align="right">
<sup>34</sup>S</th>
<th align="right">
<sup>36</sup>S</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">5731.608</td>
<td align="right">0.11230235</td>
<td align="right">377</td>
<td align="right">0</td>
<td align="right">252</td>
<td align="right">2</td>
<td align="right">65</td>
<td align="right">0</td>
<td align="right">75</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr>
<td align="right">5732.611</td>
<td align="right">0.10287789</td>
<td align="right">377</td>
<td align="right">0</td>
<td align="right">251</td>
<td align="right">3</td>
<td align="right">65</td>
<td align="right">0</td>
<td align="right">75</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr>
<td align="right">5730.604</td>
<td align="right">0.08140375</td>
<td align="right">377</td>
<td align="right">0</td>
<td align="right">253</td>
<td align="right">1</td>
<td align="right">65</td>
<td align="right">0</td>
<td align="right">75</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr>
<td align="right">5733.614</td>
<td align="right">0.07040277</td>
<td align="right">377</td>
<td align="right">0</td>
<td align="right">250</td>
<td align="right">4</td>
<td align="right">65</td>
<td align="right">0</td>
<td align="right">75</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr>
<td align="right">5734.618</td>
<td align="right">0.03838961</td>
<td align="right">377</td>
<td align="right">0</td>
<td align="right">249</td>
<td align="right">5</td>
<td align="right">65</td>
<td align="right">0</td>
<td align="right">75</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr>
<td align="right">5733.603</td>
<td align="right">0.03016369</td>
<td align="right">377</td>
<td align="right">0</td>
<td align="right">252</td>
<td align="right">2</td>
<td align="right">65</td>
<td align="right">0</td>
<td align="right">75</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr>
<td align="right">5729.601</td>
<td align="right">0.02938710</td>
<td align="right">377</td>
<td align="right">0</td>
<td align="right">254</td>
<td align="right">0</td>
<td align="right">65</td>
<td align="right">0</td>
<td align="right">75</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr>
<td align="right">5734.607</td>
<td align="right">0.02763234</td>
<td align="right">377</td>
<td align="right">0</td>
<td align="right">251</td>
<td align="right">3</td>
<td align="right">65</td>
<td align="right">0</td>
<td align="right">75</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">5</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr>
<td align="right">5732.605</td>
<td align="right">0.02668241</td>
<td align="right">377</td>
<td align="right">0</td>
<td align="right">252</td>
<td align="right">2</td>
<td align="right">64</td>
<td align="right">1</td>
<td align="right">75</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>

<p>Now, how this could be of any use to <strong>you</strong>? Well, we did suppose you are rather into ...</p>

<h3>
<a id="mass-spectrometry" class="anchor" href="#mass-spectrometry" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Mass Spectrometry</h3>

<p>Say <strong>you</strong> hoped to know, if <em>Bovine Insulin</em> is present in the sample you analyzed with your <a href="https://en.wikipedia.org/wiki/Mass_spectrometry"><strong>mass spectrometer</strong></a>.
How would you do that? </p>

<p>You would use our software to generate the isotopologues and then try to find them in the experimental spectrum.</p>

<h2>
<a id="how-to-install-isospec" class="anchor" href="#how-to-install-isospec" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>How to install IsoSpec?</h2>

<p>IsoSpec is written in <strong>C++</strong> has bindings to <strong>Python</strong>, <strong>R</strong>, and <strong>C</strong>.</p>

<h3>
<a id="python" class="anchor" href="#python" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Python</h3>

<p><strong>IMPORTANT</strong>: please note that the Python package is standalone, in the
sense that it does not need the C/C++ library to be installed separately.</p>

<p>Requirements:</p>

<ul>
<li>Python (v2 and v3 are </li>
<li>C++11 compiler: clang++ (v3.3 or later) or g++ (v4.7 or later)</li>
<li>setuptools</li>
<li>cffi (this, if not present, will be automatically downloaded and
      installed by the setup script, however you may prefer to use 
      your distribution's package manager to install that)</li>
</ul>

<pre><code>pip install IsoSpecPy
</code></pre>

<p>alternatively, you can download our package from here and then</p>

<pre><code>cd IsoSpecPy
sudo python setup.py install
</code></pre>

<p>Again, clang++ is the preferred compiler and will be used if found by the 
setup script. If you want to override the behaviour (if you have clang++ 
installed, but still want to use g++) you will have to replace the last 
command with:</p>

<pre><code>ISO_USE_DEFAULT_CXX=TRUE sudo python setup.py install
</code></pre>

<h3>
<a id="r" class="anchor" href="#r" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>R</h3>

<p>Requirements:</p>

<ul>
<li>R (&gt;= 3.2.1)</li>
</ul>

<p>Until the package will find its way on CRAN and BioConductor, you have to </p>

<ol>
<li>Download the package.</li>
<li>Move to the folder containing the IsoSpecR folder. </li>
<li>Run in terminal</li>
</ol>

<pre><code>    R CMD build IsoSpecR 
    R CMD INSTALL IsoSpecR_1.0.tar.gz  
</code></pre>

<p>All necessary packages should download automatically. </p>

<h3>
<a id="cc" class="anchor" href="#cc" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>C/C++</h3>

<p>Requirements:</p>

<ul>
<li>C++11 compiler: clang++ (v3.3 or later) or g++ (v4.7 or later)</li>
<li>Make (GNU make is OK)</li>
</ul>

<p>Note: clang++ is the default (and preferred) compiler as it produces 
faster code (in our tests, the difference in speed is about 20%). 
If you'd like to use g++ instead, please edit the first line of 
IsoSpec++/Makefile appropriately.</p>

<p>Next, execute the following commands:</p>

<pre><code>cd IsoSpec++
make
</code></pre>

<p>You may copy the resulting .so file to a convenient location.
If you wish to develop software using this library, you will also 
have to place the header files (<em>.hpp/</em>.h) somewhere your C/C++
compiler can find them.</p>

<h2>
<a id="here-are-some-example-sessions" class="anchor" href="#here-are-some-example-sessions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Here are some example sessions:</h2>

<h3>
<a id="python-1" class="anchor" href="#python-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Python</h3>

<div class="highlight highlight-source-python"><pre><span class="pl-c"># Calculates the isotopic distribution of water in several ways</span>

<span class="pl-k">from</span> IsoSpecPy <span class="pl-k">import</span> IsoSpecPy
<span class="pl-k">from</span> math <span class="pl-k">import</span> exp

i <span class="pl-k">=</span> IsoSpecPy.IsoSpec.IsoFromFormula(<span class="pl-s"><span class="pl-pds">"</span>H2O1<span class="pl-pds">"</span></span>, <span class="pl-c1">0.9</span>)

<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>The isotopologue set containing at least 0.9 probability has<span class="pl-pds">"</span></span>, <span class="pl-c1">len</span>(i), <span class="pl-s"><span class="pl-pds">"</span>element(s)<span class="pl-pds">"</span></span>

confs <span class="pl-k">=</span> i.getConfs()

<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>The first configuration has the following parameters:<span class="pl-pds">"</span></span>
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>Mass:<span class="pl-pds">"</span></span>, confs[<span class="pl-c1">0</span>][<span class="pl-c1">0</span>]
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>log(probability):<span class="pl-pds">"</span></span>, confs[<span class="pl-c1">0</span>][<span class="pl-c1">1</span>] 
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>probability:<span class="pl-pds">"</span></span>, exp(confs[<span class="pl-c1">0</span>][<span class="pl-c1">1</span>])
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>Number of Protium atoms:<span class="pl-pds">"</span></span>, confs[<span class="pl-c1">0</span>][<span class="pl-c1">2</span>][<span class="pl-c1">0</span>][<span class="pl-c1">0</span>]
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>Number of Deuterium atoms<span class="pl-pds">"</span></span>, confs[<span class="pl-c1">0</span>][<span class="pl-c1">2</span>][<span class="pl-c1">0</span>][<span class="pl-c1">1</span>]
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>Number of O16 atoms:<span class="pl-pds">"</span></span>, confs[<span class="pl-c1">0</span>][<span class="pl-c1">2</span>][<span class="pl-c1">1</span>][<span class="pl-c1">0</span>]
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>Number of O17 atoms:<span class="pl-pds">"</span></span>, confs[<span class="pl-c1">0</span>][<span class="pl-c1">2</span>][<span class="pl-c1">1</span>][<span class="pl-c1">1</span>]
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>Number of O18 atoms:<span class="pl-pds">"</span></span>, confs[<span class="pl-c1">0</span>][<span class="pl-c1">2</span>][<span class="pl-c1">1</span>][<span class="pl-c1">2</span>]

<span class="pl-c1">print</span>
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>Now what if both isotopes of hydrogen were equally probable, while prob. of O16 was 50%, O17 at 30<span class="pl-c1">% a</span>nd O18 at 20%?<span class="pl-pds">"</span></span>

hydrogen_probs <span class="pl-k">=</span> (<span class="pl-c1">0.5</span>, <span class="pl-c1">0.5</span>)
oxygen_probs <span class="pl-k">=</span> (<span class="pl-c1">0.5</span>, <span class="pl-c1">0.3</span>, <span class="pl-c1">0.2</span>)
hydrogen_masses <span class="pl-k">=</span> (<span class="pl-c1">1.00782503207</span>, <span class="pl-c1">2.0141017778</span>)
oxygen_masses <span class="pl-k">=</span> (<span class="pl-c1">15.99491461956</span>, <span class="pl-c1">16.99913170</span>, <span class="pl-c1">17.9991610</span>)
atom_counts <span class="pl-k">=</span> (<span class="pl-c1">2</span>, <span class="pl-c1">1</span>)

i <span class="pl-k">=</span> IsoSpecPy.IsoSpec(atom_counts, (hydrogen_masses, oxygen_masses), (hydrogen_probs, oxygen_probs), <span class="pl-c1">0.9</span>)

<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>The isotopologue set containing at least 0.9 probability has<span class="pl-pds">"</span></span>, <span class="pl-c1">len</span>(i), <span class="pl-s"><span class="pl-pds">"</span>element(s)<span class="pl-pds">"</span></span>

confs <span class="pl-k">=</span> i.getConfs()

<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>The first configuration has the following parameters:<span class="pl-pds">"</span></span>
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>Mass:<span class="pl-pds">"</span></span>, confs[<span class="pl-c1">0</span>][<span class="pl-c1">0</span>]
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>log-prob:<span class="pl-pds">"</span></span>, confs[<span class="pl-c1">0</span>][<span class="pl-c1">1</span>]
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>probability:<span class="pl-pds">"</span></span>, exp(confs[<span class="pl-c1">0</span>][<span class="pl-c1">1</span>])
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>Number of Protium atoms:<span class="pl-pds">"</span></span>, confs[<span class="pl-c1">0</span>][<span class="pl-c1">2</span>][<span class="pl-c1">0</span>][<span class="pl-c1">0</span>]
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>Number of Deuterium atoms<span class="pl-pds">"</span></span>, confs[<span class="pl-c1">0</span>][<span class="pl-c1">2</span>][<span class="pl-c1">0</span>][<span class="pl-c1">1</span>]
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>Number of O16 atoms:<span class="pl-pds">"</span></span>, confs[<span class="pl-c1">0</span>][<span class="pl-c1">2</span>][<span class="pl-c1">1</span>][<span class="pl-c1">0</span>]
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>Number of O17 atoms:<span class="pl-pds">"</span></span>, confs[<span class="pl-c1">0</span>][<span class="pl-c1">2</span>][<span class="pl-c1">1</span>][<span class="pl-c1">1</span>]
<span class="pl-c1">print</span> <span class="pl-s"><span class="pl-pds">"</span>Number of O18 atoms:<span class="pl-pds">"</span></span>, confs[<span class="pl-c1">0</span>][<span class="pl-c1">2</span>][<span class="pl-c1">1</span>][<span class="pl-c1">2</span>]</pre></div>

<h3>
<a id="r-1" class="anchor" href="#r-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>R</h3>

<div class="highlight highlight-source-r"><pre>library(<span class="pl-smi">IsoSpecR</span>)

<span class="pl-c"># A water molecule:</span>
<span class="pl-smi">water</span> <span class="pl-k">&lt;-</span> c(<span class="pl-v">H</span><span class="pl-k">=</span><span class="pl-c1">2</span>,<span class="pl-v">O</span><span class="pl-k">=</span><span class="pl-c1">1</span>)

<span class="pl-c"># Desired joint probability p of the p-optimal set of isotopologues (90%): </span>
<span class="pl-smi">p</span> <span class="pl-k">&lt;-</span> .<span class="pl-c1">9</span>

<span class="pl-c"># The fancy representation of the results is on.</span>
<span class="pl-c"># ATTENTION: while turned on, the algorithm's time complexity is nlog(n) instead of linear.</span>
<span class="pl-smi">res</span> <span class="pl-k">&lt;-</span> IsoSpecify( <span class="pl-v">molecule</span><span class="pl-k">=</span><span class="pl-smi">water</span>, <span class="pl-v">stopCondition</span><span class="pl-k">=</span>.<span class="pl-c1">99</span>, <span class="pl-v">fancy</span><span class="pl-k">=</span><span class="pl-c1">TRUE</span> )

print(<span class="pl-s"><span class="pl-pds">'</span>The first configuration has the following parameters:<span class="pl-pds">'</span></span>)
print(<span class="pl-s"><span class="pl-pds">'</span>Mass:<span class="pl-pds">'</span></span>);<span class="pl-smi">res</span><span class="pl-k">$</span><span class="pl-smi">mass</span>
print(<span class="pl-s"><span class="pl-pds">'</span>log(probability):<span class="pl-pds">'</span></span>);<span class="pl-smi">res</span><span class="pl-k">$</span><span class="pl-smi">logProb</span>
print(<span class="pl-s"><span class="pl-pds">'</span>probability:<span class="pl-pds">'</span></span>);<span class="pl-smi">res</span><span class="pl-k">$</span><span class="pl-smi">prob</span>
print(<span class="pl-s"><span class="pl-pds">'</span>Number of Protium atoms:<span class="pl-pds">'</span></span>);<span class="pl-smi">res</span><span class="pl-k">$</span><span class="pl-smi">H1</span>
print(<span class="pl-s"><span class="pl-pds">'</span>Number of Deuterium atoms:<span class="pl-pds">'</span></span>);<span class="pl-smi">res</span><span class="pl-k">$</span><span class="pl-smi">H2</span>
print(<span class="pl-s"><span class="pl-pds">'</span>Number of O16 atoms:<span class="pl-pds">'</span></span>);<span class="pl-smi">res</span><span class="pl-k">$</span><span class="pl-smi">O16</span>
print(<span class="pl-s"><span class="pl-pds">'</span>Number of O17 atoms:<span class="pl-pds">'</span></span>);<span class="pl-smi">res</span><span class="pl-k">$</span><span class="pl-smi">O17</span>
print(<span class="pl-s"><span class="pl-pds">'</span>Number of O18 atoms:<span class="pl-pds">'</span></span>);<span class="pl-smi">res</span><span class="pl-k">$</span><span class="pl-smi">O18</span>

print(<span class="pl-s"><span class="pl-pds">"</span>Now what if both isotopes of hydrogen were equally probable, while prob. of O16 was 50%, O17 at 30% and O18 at 20%?<span class="pl-pds">"</span></span>)
print(<span class="pl-s"><span class="pl-pds">'</span>In R, we have to preper additional parameter for the algorithm: a data.frame containing the new isotopic ratios.<span class="pl-pds">'</span></span>)
<span class="pl-smi">modifiedIsotopes</span> <span class="pl-k">&lt;-</span> <span class="pl-k">data.frame</span>(
    <span class="pl-v">element</span> <span class="pl-k">=</span> c(<span class="pl-s"><span class="pl-pds">'</span>H<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>H<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>O<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>O<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>O<span class="pl-pds">'</span></span>),
    <span class="pl-v">isotope</span> <span class="pl-k">=</span> c(<span class="pl-s"><span class="pl-pds">'</span>H1<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>H2<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>O16<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>O17<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>O18<span class="pl-pds">'</span></span>),
    <span class="pl-v">mass</span>    <span class="pl-k">=</span> c(<span class="pl-c1">1.00782503207</span>, <span class="pl-c1">2.0141017778</span>,<span class="pl-c1">15.99491461956</span>, <span class="pl-c1">16.99913170</span>, <span class="pl-c1">17.9991610</span>),
    <span class="pl-v">abundance</span> <span class="pl-k">=</span> c(<span class="pl-c1">0.5</span>, <span class="pl-c1">0.5</span>,<span class="pl-c1">0.5</span>, <span class="pl-c1">0.3</span>, <span class="pl-c1">0.2</span>)
)

<span class="pl-smi">modRes</span> <span class="pl-k">&lt;-</span> IsoSpecify( <span class="pl-v">molecule</span><span class="pl-k">=</span><span class="pl-smi">water</span>, <span class="pl-v">stopCondition</span><span class="pl-k">=</span>.<span class="pl-c1">99</span>, <span class="pl-v">fancy</span><span class="pl-k">=</span><span class="pl-c1">TRUE</span>, <span class="pl-v">isotopes</span><span class="pl-k">=</span><span class="pl-smi">modifiedIsotopes</span> )

print(<span class="pl-s"><span class="pl-pds">'</span>The number of configuration must be bigger, the probability being less concentrated on any isotope.<span class="pl-pds">'</span></span>)
<span class="pl-smi">modRes</span></pre></div>

<h3>
<a id="c" class="anchor" href="#c" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>C++</h3>

<div class="highlight highlight-source-c++"><pre>
#<span class="pl-k">include</span> <span class="pl-s"><span class="pl-pds">&lt;</span>iostream<span class="pl-pds">&gt;</span></span>
#<span class="pl-k">include</span> <span class="pl-s"><span class="pl-pds">"</span>../../IsoSpec++/isoSpec++.hpp<span class="pl-pds">"</span></span>


<span class="pl-k">int</span> <span class="pl-en">main</span>()
{
    IsoSpec* iso = <span class="pl-c1">IsoSpec::IsoFromFormula</span>(<span class="pl-s"><span class="pl-pds">"</span>H2O1<span class="pl-pds">"</span></span>, <span class="pl-c1">0.9</span>);

    iso-&gt;<span class="pl-c1">processConfigurationsUntilCutoff</span>();

    std::cout &lt;&lt;  <span class="pl-s"><span class="pl-pds">"</span>The isotopologue set containing at least 0.9 probability has <span class="pl-pds">"</span></span> &lt;&lt; iso-&gt;<span class="pl-c1">getNoVisitedConfs</span>() &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span> element(s)<span class="pl-pds">"</span></span> &lt;&lt; std::endl;

    std::tuple&lt;<span class="pl-k">double</span>*,<span class="pl-k">double</span>*,<span class="pl-k">int</span>*,<span class="pl-k">int</span>&gt; product = iso-&gt;<span class="pl-c1">getCurrentProduct</span>();

    <span class="pl-k">double</span>* masses = std::get&lt;<span class="pl-c1">0</span>&gt;(product);
    <span class="pl-k">double</span>* logprobs = std::get&lt;<span class="pl-c1">1</span>&gt;(product);
    <span class="pl-k">int</span>* configs = std::get&lt;<span class="pl-c1">2</span>&gt;(product);

    std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>The first configuration has the following parameters: <span class="pl-pds">"</span></span> &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>Mass: <span class="pl-pds">"</span></span> &lt;&lt; masses[<span class="pl-c1">0</span>] &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>log-prob: <span class="pl-pds">"</span></span> &lt;&lt; logprobs[<span class="pl-c1">0</span>] &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>probability: <span class="pl-pds">"</span></span> &lt;&lt; <span class="pl-c1">exp</span>(logprobs[<span class="pl-c1">0</span>]) &lt;&lt; std::endl;

    <span class="pl-c">// Successive isotopologues are ordered by the appearance in the formula of the element, then by nucleon number, and concatenated into one array</span>
    std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>Protium atoms: <span class="pl-pds">"</span></span> &lt;&lt; configs[<span class="pl-c1">0</span>] &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>Deuterium atoms <span class="pl-pds">"</span></span> &lt;&lt; configs[<span class="pl-c1">1</span>] &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>O16 atoms: <span class="pl-pds">"</span></span> &lt;&lt; configs[<span class="pl-c1">2</span>] &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>O17 atoms: <span class="pl-pds">"</span></span> &lt;&lt; configs[<span class="pl-c1">3</span>] &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>O18 atoms: <span class="pl-pds">"</span></span> &lt;&lt; configs[<span class="pl-c1">4</span>] &lt;&lt; std::endl;

    <span class="pl-k">delete</span> iso;
    <span class="pl-k">delete</span> masses;
    <span class="pl-k">delete</span> logprobs;
    <span class="pl-k">delete</span> configs;


    std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>Now what if both isotopes of hydrogen were equally probable, while prob. of O16 was 50<span class="pl-ii">%</span>, O17 at 30<span class="pl-c1">% a</span>nd O18 at 20<span class="pl-ii">%</span>?<span class="pl-pds">"</span></span> &lt;&lt; std::endl;

    <span class="pl-k">const</span> <span class="pl-k">int</span> elementNumber = <span class="pl-c1">2</span>;
    <span class="pl-k">const</span> <span class="pl-k">int</span> isotopeNumbers[<span class="pl-c1">2</span>] = {<span class="pl-c1">2</span>,<span class="pl-c1">3</span>};

    <span class="pl-k">const</span> <span class="pl-k">int</span> atomCounts[<span class="pl-c1">2</span>] = {<span class="pl-c1">2</span>,<span class="pl-c1">1</span>};


    <span class="pl-k">const</span> <span class="pl-k">double</span> hydrogen_masses[<span class="pl-c1">2</span>] = {<span class="pl-c1">1.00782503207</span>, <span class="pl-c1">2.0141017778</span>};
    <span class="pl-k">const</span> <span class="pl-k">double</span> oxygen_masses[<span class="pl-c1">3</span>] = {<span class="pl-c1">15.99491461956</span>, <span class="pl-c1">16.99913170</span>, <span class="pl-c1">17.9991610</span>};

    <span class="pl-k">const</span> <span class="pl-k">double</span>* isotope_masses[<span class="pl-c1">2</span>] = {hydrogen_masses, oxygen_masses};

    <span class="pl-k">const</span> <span class="pl-k">double</span> hydrogen_probs[<span class="pl-c1">2</span>] = {<span class="pl-c1">0.5</span>, <span class="pl-c1">0.5</span>};
    <span class="pl-k">const</span> <span class="pl-k">double</span> oxygen_probs[<span class="pl-c1">3</span>] = {<span class="pl-c1">0.5</span>, <span class="pl-c1">0.3</span>, <span class="pl-c1">0.2</span>};

    <span class="pl-k">const</span> <span class="pl-k">double</span>* probs[<span class="pl-c1">2</span>] = {hydrogen_probs, oxygen_probs};



    iso = <span class="pl-k">new</span> <span class="pl-c1">IsoSpecLayered</span>(elementNumber, isotopeNumbers, atomCounts, isotope_masses, probs, <span class="pl-c1">0.9</span>);

    iso-&gt;<span class="pl-c1">processConfigurationsUntilCutoff</span>();

    std::cout &lt;&lt;  <span class="pl-s"><span class="pl-pds">"</span>The isotopologue set containing at least 0.9 probability has <span class="pl-pds">"</span></span> &lt;&lt; iso-&gt;<span class="pl-c1">getNoVisitedConfs</span>() &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span> element(s)<span class="pl-pds">"</span></span> &lt;&lt; std::endl;

    product = iso-&gt;<span class="pl-c1">getCurrentProduct</span>();

    masses = std::get&lt;<span class="pl-c1">0</span>&gt;(product);
    logprobs = std::get&lt;<span class="pl-c1">1</span>&gt;(product);
    configs = std::get&lt;<span class="pl-c1">2</span>&gt;(product);

    std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>The first configuration has the following parameters: <span class="pl-pds">"</span></span> &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>Mass: <span class="pl-pds">"</span></span> &lt;&lt; masses[<span class="pl-c1">0</span>] &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>log-prob: <span class="pl-pds">"</span></span> &lt;&lt; logprobs[<span class="pl-c1">0</span>] &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>probability: <span class="pl-pds">"</span></span> &lt;&lt; <span class="pl-c1">exp</span>(logprobs[<span class="pl-c1">0</span>]) &lt;&lt; std::endl;

    <span class="pl-c">// Successive isotopologues are ordered by the appearance in the formula of the element, then by nucleon number, and concatenated into one array</span>
    std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>Protium atoms: <span class="pl-pds">"</span></span> &lt;&lt; configs[<span class="pl-c1">0</span>] &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>Deuterium atoms <span class="pl-pds">"</span></span> &lt;&lt; configs[<span class="pl-c1">1</span>] &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>O16 atoms: <span class="pl-pds">"</span></span> &lt;&lt; configs[<span class="pl-c1">2</span>] &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>O17 atoms: <span class="pl-pds">"</span></span> &lt;&lt; configs[<span class="pl-c1">3</span>] &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="pl-s"><span class="pl-pds">"</span>O18 atoms: <span class="pl-pds">"</span></span> &lt;&lt; configs[<span class="pl-c1">4</span>] &lt;&lt; std::endl;

    <span class="pl-k">delete</span> iso;
    <span class="pl-k">delete</span> masses;
    <span class="pl-k">delete</span> logprobs;
    <span class="pl-k">delete</span> configs;
}</pre></div>

<h2>
<a id="interested-in-isospec" class="anchor" href="#interested-in-isospec" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Interested in IsoSpec?</h2>

<p>Contact us! Mail to:</p>

<ul>
<li>
<a href="mailto:matteo.lacki@gmail.com">matteo.lacki@gmail.com</a> </li>
</ul>

<p>or </p>

<ul>
<li><a href="mailto:mist@mimuw.edu.pl">mist@mimuw.edu.pl</a></li>
</ul>

<p>and we might help you in including our software in your project!</p>
      </section>
    </div>

    
  </body>
</html>
