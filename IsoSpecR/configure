#!/bin/sh

exit 0

# Basically just detect clang++ and if present use it in preference over g++
echo -n "Checking for working clang++ with c++11 support... "
CLANG="clang++ -fsyntax-only `R CMD config CPPFLAGS` `R CMD config --cppflags` `echo 'Rcpp:::CxxFlags()' | R --vanilla --slave` src/*.cpp"
if $CLANG -std=c++11 2> /dev/null
then
	echo "Found. Using -std=c++11"
	STDCXX="-std=c++11"
elif $CLANG -std=gnu++11 2> /dev/null
then
	echo "Found. Using -std=gnu++11"
	STDCXX="-std=gnu++11"
elif $CLANG -std=c++0x 2> /dev/null
then 
	echo "Found. Using -std=c++0x"
	STDCXX="-std=c++0x"
else
	echo "Not found. Using default compiler, probably g++. Please note that clang++ generates much faster code, and consider installing it."
fi

echo "CXX_STD = CXX11" > Makevars

if [ ! -z $STDCXX ]
then
	echo "CXX1X = clang++" >> Makevars
	echo "CXX1XSTD = $STDCXX" >> Makevars
	echo "PKGCXX1X = clang++" >> Makevars
	echo "PKG_CXX1XSTD = $STDCXX" >> Makevars
fi


echo "CXX1XFLAGS = -march=native -mtune=native -O3 -DBUILDING_R" >> Makevars
echo "PKG_CXX1XFLAGS = -march=native -mtune=native -O3 -DBUILDING_R" >> Makevars



